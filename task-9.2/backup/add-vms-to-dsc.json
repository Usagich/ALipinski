{
    "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "resources": [
        {
          "type": "Microsoft.Compute/virtualMachines/extensions",
          "name": "[concat('vm1','/Microsoft.Powershell.DSC')]",
          "apiVersion": "2015-06-15",
          "location": "west europe",
          "properties": {
            "publisher": "Microsoft.Powershell",
            "type": "DSC",
            "typeHandlerVersion": "2.19",
            "autoUpgradeMinorVersion": true,
            "protectedSettings": {
              "Items": {
                "registrationKeyPrivate": "4pD8zflhUyCH5s//+VV6mg9pR28LFmtIWCoX/yXpfnR1q+r+4XmA7o+pqO9d1w2KX7WBko7q7Bq8yj38zVlq1Q=="
              }
            },
            "settings": {
              
              "SasToken": "",
              "ConfigurationFunction": "",
              "Properties": [
                {
                  "Name": "RegistrationKey",
                  "Value": {
                    "UserName": "PLACEHOLDER_DONOTUSE",
                    "Password": "PrivateSettingsRef:registrationKeyPrivate"
                  },
                  "TypeName": "System.Management.Automation.PSCredential"
                },
                {
                  "Name": "RegistrationUrl",
                  "Value": "https://we-agentservice-prod-1.azure-automation.net/accounts/85aefa64-8a5b-4aa1-b7f2-ded4d3be2fcb",
                  "TypeName": "System.String"
                },
                {
                  "Name": "NodeConfigurationName",
                  "Value": "",
                  "TypeName": "System.String"
                },
                {
                  "Name": "ConfigurationMode",
                  "Value": "ApplyAndMonitor",
                  "TypeName": "System.String"
                },
                {
                  "Name": "ConfigurationModeFrequencyMins",
                  "Value": 15,
                  "TypeName": "System.Int32"
                },
                {
                  "Name": "RefreshFrequencyMins",
                  "Value": 30,
                  "TypeName": "System.Int32"
                },
                {
                  "Name": "RebootNodeIfNeeded",
                  "Value": true,
                  "TypeName": "System.Boolean"
                },
                {
                  "Name": "ActionAfterReboot",
                  "Value": "ContinueConfiguration",
                  "TypeName": "System.String"
                },
                {
                  "Name": "AllowModuleOverwrite",
                  "Value": false,
                  "TypeName": "System.Boolean"
                },
                {
                  "Name": "Timestamp",
                  "Value": "MM/dd/yyyy H:mm:ss tt",
                  "TypeName": "System.String"
                }
              ]
            }
          }
        }
      ]
}